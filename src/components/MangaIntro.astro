---
import { getManga } from "../data/manga";
import { siteConfig } from "../data/site-config";
import { Image } from "astro:assets";
import introImage from "../assets/intro-cover.webp";

const manga = getManga();

// SEO metadata
const jsonLd = {
  "@context": "https://schema.org",
  "@type": "Book",
  name: manga.title,
  description: manga.description,
  author: {
    "@type": "Person",
    name: siteConfig.author,
  },
  numberOfPages: manga.chapters.length,
  publisher: siteConfig.name,
  genre: manga.tags.map((tag) => tag.name).join(", "),
  inLanguage: "en",
};
---

<section
  class="bg-gray-800 rounded-lg p-6 mb-12"
  aria-labelledby=`${siteConfig.title}`
>
  <div class="flex flex-col md:flex-row gap-8">
    <div class="w-full md:w-1/3 lg:w-1/4">
      <div class="relative aspect-[2/3] rounded-lg overflow-hidden">
        <div
          class="absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse"
        >
        </div>
        <Image
          src={introImage}
          alt={`Cover image for ${manga.title} manga`}
          width={600}
          height={900}
          class="relative z-10 w-full h-full object-cover"
          loading="eager"
          decoding="async"
          format="webp"
          quality={80}
        />
      </div>
    </div>

    <div class="flex-1">
      <header>
        <h1 id="manga-title" class="text-2xl font-bold mb-4">
          About {manga.title}
        </h1>
      </header>

      <div class="prose dark:prose-invert max-w-none">
        <p class="mb-4 text-lg">{manga.description}</p>

        <!-- <dl class="grid grid-cols-2 sm:grid-cols-3 gap-4 mt-6">
          <div class="bg-gray-100 dark:bg-gray-700 px-4 py-3 rounded-lg">
            <dt class="text-sm text-gray-600 dark:text-gray-400">Status</dt>
            <dd class="font-semibold">{siteConfig.status}</dd>
          </div>

          <div class="bg-gray-100 dark:bg-gray-700 px-4 py-3 rounded-lg">
            <dt class="text-sm text-gray-600 dark:text-gray-400">Chapters</dt>
            <dd class="font-semibold">{manga.chapters.length}</dd>
          </div>

          <div class="bg-gray-100 dark:bg-gray-700 px-4 py-3 rounded-lg">
            <dt class="text-sm text-gray-600 dark:text-gray-400">Author</dt>
            <dd class="font-semibold">{siteConfig.author}</dd>
          </div>
        </dl> -->
        <div class="flex flex-wrap gap-4 mt-6">
          <div
            class="bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-lg w-[120px]"
          >
            <span class="block text-sm text-gray-600 dark:text-gray-400"
              >Status</span
            >
            <span class="font-semibold">{siteConfig.status}</span>
          </div>
          <div
            class="bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-lg w-[120px]"
          >
            <span class="block text-sm text-gray-600 dark:text-gray-400"
              >Chapters</span
            >
            <span class="font-semibold">{manga.chapters.length}</span>
          </div>
          <div
            class="bg-gray-100 dark:bg-gray-700 px-4 py-2 rounded-lg w-[120px]"
          >
            <span class="block text-sm text-gray-600 dark:text-gray-400"
              >Author</span
            >
            <span class="font-semibold">{siteConfig.author}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Structured Data for SEO -->
<script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />

<style>
  /* Optimize CLS by maintaining aspect ratio */
  .aspect-\[2\/3\] {
    aspect-ratio: 2/3;
  }

  /* Ensure smooth animation for loading state */
  .animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  @keyframes pulse {
    0%,
    100% {
      opacity: 1;
    }
    50% {
      opacity: 0.5;
    }
  }

  /* Improve performance with GPU acceleration */
  .relative {
    transform: translateZ(0);
    will-change: transform;
  }
</style>
